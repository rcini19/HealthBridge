<!-- All Medicines Modal -->
<div class="modal-overlay" id="allMedicinesModal">
  <div class="modal-container modal-wide">
    <div class="modal-header">
      <h2 class="modal-title">Browse Medicines to Request</h2>
      <button class="modal-close" onclick="closeAllMedicinesModal()">√ó</button>
    </div>
    <div class="modal-body">
      <div class="modal-info-text">
        üí° <em>Click image to view details</em>
      </div>
      <div class="modal-search-bar">
        <input type="text" id="medicineSearch" class="form-input" placeholder="Search medicines..." autocomplete="off">
        <div id="autocomplete-suggestions" class="autocomplete-suggestions"></div>
      </div>
      
      <!-- Expiry Range Filter -->
      <div class="filter-section" style="margin: 1rem 0; display: flex; gap: 1rem; align-items: center;">
        <label style="font-weight: 600; color: #374151;">Filter by Expiry:</label>
        <select id="expiryFilter" class="form-input" style="max-width: 200px;" onchange="filterByExpiry()">
          <option value="all">All Medicines</option>
          <option value="7">Expires within 7 days</option>
          <option value="14">Expires within 14 days</option>
          <option value="30">Expires within 30 days</option>
          <option value="60">Expires within 60 days</option>
        </select>
      </div>
      
      <div class="medicines-grid" id="medicinesGrid">
        {% if available_medicines %}
          {% for medicine in available_medicines %}
          <div class="medicine-card" data-name="{{ medicine.name|lower }}" onclick="showMedicineDetails({{ medicine.id }})">
            {% if medicine.image %}
            <div class="medicine-image">
              <img class="medicine-image" src="{{ medicine.image.url }}" alt="{{ medicine.name }}">
            </div>
            {% endif %}
            <div class="medicine-details">
              <h3 class="medicine-title">{{ medicine.name }}</h3>
              <div class="medicine-info-row">
                <span class="medicine-label">Quantity:</span>
                <span class="medicine-value">{{ medicine.quantity }}</span>
              </div>
              <div class="medicine-info-row">
                <span class="medicine-label">Expires:</span>
                <span class="medicine-value">{{ medicine.expiry_date|date:"M d, Y" }}</span>
              </div>
              <div class="medicine-info-row">
                <span class="medicine-label">Status:</span>
                <span class="badge badge-{{ medicine.status }}">{{ medicine.get_status_display }}</span>
              </div>
              {% if medicine.days_until_expiry <= 10 %}
              <div class="medicine-expiry-alert">
                ‚ö†Ô∏è Expires in {{ medicine.days_until_expiry }} days
              </div>
              {% endif %}
              <button class="btn-primary btn-sm mt-2" onclick="event.stopPropagation(); requestThisMedicine('{{ medicine.name }}', {{ medicine.id }})">Request This</button>
            </div>
          </div>
          {% endfor %}
        {% else %}
          <div class="empty-state">
            <p class="empty-text">No medicines available at the moment</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
